{% extends "chatApp/index.html" %}
{% load static %}

{% block content %}
    {% for message in messages %}
    {% if message.sender == request.user %}
<div class="card-panel right" style="width: 75%; position: relative">
    <div style="position: absolute; top: 0; left:3px; font-weight: bolder" class="title">You</div>
    {{ message.message }}
</div>
    {% else %}
<div class="card-panel left blue lighten-5" style="width: 75%; position: relative">
    <div style="position: absolute; top: 0; left:3px; font-weight: bolder" class="title">{{ message.sender }}</div>
    {{ message.message }}
</div>

    {% endif %}
    {% endfor %}


    <div id="board" >
                  {% block messages %}
                  {% endblock %}
    </div>
    <form id="chat-box" class="form-group " method="post">
                  {% csrf_token %}
                  <div class="row">
                      <div class="col s11">
                          <div class="input-field">
                              <input id="id_message" name="message" type="text" placeholder="Type your message..">
                          </div>
                      </div>
                      <div class="col s1" style="line-height: 80px">
                          <button class="btn btn-floating blue lighten-2 waves-effect waves-light"><i class="material-icons">send</i></button>
                      </div>
                  </div>
  </form>

    <script src="{% static 'js/chat.js' %}"></script>
    <script>

        sender_id = "{{ receiver.id }}";
        receiver_id = "{{ request.user.id }}";

        //For sending
        $(function () {
            $('#chat-box').on('submit', function (event) {
                var message = $('#id_message');
                send('{{ request.user }}', '{{ receiver }}', message.val());

                message.val('');
                setInterval(receive,1000)
            })
        })
    </script>



{% endblock %}
